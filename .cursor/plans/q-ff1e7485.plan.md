<!-- ff1e7485-0af2-4dcd-8751-55f448706e7d 0581a38d-445c-4fef-906d-aaf068d74621 -->
# Qwen Curator Loop Upgrade

## Prep Config + Env

- update-config: set new defaults for `CURATOR_MODEL`, temps/thresholds, `OLLAMA_URL`, `VLLM_URL`, and hard-pin `QDRANT_DIM=896`; surface helpful error logs when env missing.

## Embedding + Qdrant Fixes

- embed-no-fallback: rework `embedding.rs` to call Ollama `CURATOR_MODEL`, drop pseudo-random fallback, enforce 896-dim with clear errors/logs.
- qdrant-dim-lock: adjust `erag.rs` (and any callers) to create/search with fixed 896 dimension and fail fast on mismatch.

## Curator Overhaul

- curator-qwen: replace heuristic curator with Ollama Qwen call producing JSON `{learned, refined, reason}` via the provided prompt; ensure explicit errors on Ollama downtime and structured logging.

## Learning + Tokenizer Loop

- learning-buffer: add curated buffer plumbingâ€”when curator marks `learned`, promote tokens via `tokenizer` API and append to LoRA buffer; train adapters (5 epochs, MSE) once buffer >10 and log progress.

## Pipeline + Generation Wiring

- pipeline-flow: wire new curator response through pipeline so learned experiences trigger tokenizer promotion, LoRA buffering, and ERAG writes; remove legacy fallback heuristics and ensure halt on missing services.
- vllm-retries: add 3-attempt retry with backoff for dispatch failures in `generation.rs`.

## Verification

- cargo-build: run `cargo build` to ensure clean compile and prep test instructions for `million_cycle_test`.

### To-dos

- [ ] Add new model/env defaults and 896-dim enforcement in config.
- [ ] Refactor embedding client to use Ollama curator model without fallback.
- [ ] Enforce 896-dim collection usage across ERAG client.
- [ ] Implement Qwen-based curator JSON workflow and logging.
- [ ] Feed curator learnings into tokenizer promotions and LoRA buffer training.
- [ ] Wire new curator outputs through pipeline and remove fallbacks.
- [ ] Add retry logic around vLLM dispatch calls.
- [ ] Compile project to confirm all changes build successfully.